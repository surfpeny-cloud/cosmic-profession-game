// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
const GAME_CONFIG = {
    totalCells: 32,
    maxPlayers: 16,
    startCoins: 50,
    targetCoins: 300,
    skipTaskPenalty: 5,
    usedTasks: new Set() // –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
};

// –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞–Ω–∏–π
const DIFFICULTY_LEVELS = {
    easy: {
        name: "–õ—ë–≥–∫–æ–µ",
        reward: 10,
        color: "#10b981",
        time: 60,
        probability: 0.5
    },
    medium: {
        name: "–°—Ä–µ–¥–Ω–µ–µ", 
        reward: 20,
        color: "#f59e0b",
        time: 90,
        probability: 0.3
    },
    hard: {
        name: "–°–ª–æ–∂–Ω–æ–µ",
        reward: 35,
        color: "#ef4444", 
        time: 120,
        probability: 0.2
    }
};

// –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–¥–∞–Ω–∏–π
const TASK_CATEGORIES = {
    creative: {
        name: "–¢–≤–æ—Ä—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ",
        icon: "üé®",
        color: "#8b5cf6"
    },
    logical: {
        name: "–õ–æ–≥–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞", 
        icon: "üß©",
        color: "#06b6d4"
    },
    social: {
        name: "–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ",
        icon: "üë•",
        color: "#10b981"
    },
    physical: {
        name: "–§–∏–∑–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ",
        icon: "üí™",
        color: "#f59e0b"
    },
    knowledge: {
        name: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–Ω–∏–π",
        icon: "üìö",
        color: "#ef4444"
    }
};

// –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
const TASKS_DATABASE = [
    // –õ–µ–≥–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è
    {
        id: "easy_1",
        difficulty: "easy",
        category: "creative",
        title: "–ù–∞—Ä–∏—Å—É–π –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –¥—Ä—É–≥–∞",
        description: "–ó–∞ 1 –º–∏–Ω—É—Ç—É –Ω–∞—Ä–∏—Å—É–π –∏–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–≥ –±—ã —Å—Ç–∞—Ç—å —Ç–≤–æ–∏–º –¥—Ä—É–≥–æ–º –≤ –∫–æ—Å–º–æ—Å–µ.",
        hint: "–ù–µ –±–æ–π—Å—è —Ñ–∞–Ω—Ç–∞–∑–∏—Ä–æ–≤–∞—Ç—å! –ò—Å–ø–æ–ª—å–∑—É–π –Ω–µ–æ–±—ã—á–Ω—ã–µ —Ü–≤–µ—Ç–∞ –∏ —Ñ–æ—Ä–º—ã."
    },
    {
        id: "easy_2", 
        difficulty: "easy",
        category: "social",
        title: "–ö–æ–º–ø–ª–∏–º–µ–Ω—Ç –∫–æ—Å–º–æ–Ω–∞–≤—Ç—É",
        description: "–°–¥–µ–ª–∞–π –∏—Å–∫—Ä–µ–Ω–Ω–∏–π –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ª—é–±–æ–º—É –∏–≥—Ä–æ–∫—É –∑–∞ –µ–≥–æ –∫–æ—Å–º–∏—á–µ—Å–∫–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.",
        hint: "–ë—É–¥—å –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω –∫ –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–∞–º –∏ –∏—Ö —É—Å–ø–µ—Ö–∞–º."
    },
    {
        id: "easy_3",
        difficulty: "easy", 
        category: "knowledge",
        title: "–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞",
        description: "–ù–∞–∑–æ–≤–∏ 3 –ø–ª–∞–Ω–µ—Ç—ã –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –ø–æ –æ–¥–Ω–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–º—É —Ñ–∞–∫—Ç—É –æ –∫–∞–∂–¥–æ–π.",
        hint: "–í—Å–ø–æ–º–Ω–∏ —à–∫–æ–ª—å–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–∏–¥—É–º–∞–π —Ñ–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç—ã!"
    },
    {
        id: "easy_4",
        difficulty: "easy",
        category: "physical", 
        title: "–ù–µ–≤–µ—Å–æ–º–æ—Å—Ç—å",
        description: "–ò–∑–æ–±—Ä–∞–∑–∏, –∫–∞–∫ —Ç—ã –¥–≤–∏–≥–∞–µ—à—å—Å—è –≤ –Ω–µ–≤–µ—Å–æ–º–æ—Å—Ç–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥.",
        hint: "–ü–ª–∞–≤–Ω—ã–µ, –º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è –∫–∞–∫ –±—É–¥—Ç–æ —Ç—ã –ø–∞—Ä–∏—à—å –≤ –≤–æ–∑–¥—É—Ö–µ."
    },
    {
        id: "easy_5",
        difficulty: "easy",
        category: "logical",
        title: "–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥–∞–¥–∫–∞", 
        description: "–ß—Ç–æ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏?",
        hint: "–ü–æ–¥—É–º–∞–π –æ —Å–Ω–∞—Ö –∏ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–∏."
    },

    // –°—Ä–µ–¥–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
    {
        id: "medium_1",
        difficulty: "medium",
        category: "creative", 
        title: "–î–∏–∑–∞–π–Ω –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ—Ä–∞–±–ª—è",
        description: "–ü—Ä–∏–¥—É–º–∞–π –∏ –æ–ø–∏—à–∏ –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–∞–±–ª—å –±—É–¥—É—â–µ–≥–æ —Å —Ç—Ä–µ–º—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.",
        hint: "–í–¥–æ—Ö–Ω–æ–≤–∏—Å—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –∏ –Ω–∞—É—á–Ω–æ–π —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–æ–π."
    },
    {
        id: "medium_2",
        difficulty: "medium",
        category: "social",
        title: "–ú–µ–∂–≥–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –¥–∏–ø–ª–æ–º–∞—Ç", 
        description: "–ü—Ä–∏–¥—É–º–∞–π —Å–ø–æ—Å–æ–± –æ–±—â–µ–Ω–∏—è —Å –∏–Ω–æ–ø–ª–∞–Ω–µ—Ç–Ω–æ–π —Ä–∞—Å–æ–π, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –∑–µ–º–Ω—ã–µ —è–∑—ã–∫–∏.",
        hint: "–Ø–∑—ã–∫ –∂–µ—Å—Ç–æ–≤, –º—É–∑—ã–∫–∏ –∏–ª–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º."
    },
    {
        id: "medium_3",
        difficulty: "medium",
        category: "knowledge",
        title: "–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –∏–Ω–∂–µ–Ω–µ—Ä", 
        description: "–û–ø–∏—à–∏, –∫–∞–∫ –±—ã —Ç—ã —Ä–µ—à–∏–ª –ø—Ä–æ–±–ª–µ–º—É –Ω–µ—Ö–≤–∞—Ç–∫–∏ –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –Ω–∞ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —Å—Ç–∞–Ω—Ü–∏–∏.",
        hint: "–ü–æ–¥—É–º–∞–π –æ —Ä–∞—Å—Ç–µ–Ω–∏—è—Ö, –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–µ –∏–ª–∏ –Ω–æ–≤—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö."
    },
    {
        id: "medium_4",
        difficulty: "medium",
        category: "physical",
        title: "–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π —Ç–∞–Ω–µ—Ü", 
        description: "–ü—Ä–∏–¥—É–º–∞–π –∏ —Å—Ç–∞–Ω—Ü—É–π —Ç–∞–Ω–µ—Ü, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–ª –±—ã –∂–∏–∑–Ω—å –≤ –Ω–µ–≤–µ—Å–æ–º–æ—Å—Ç–∏.",
        hint: "–ò—Å–ø–æ–ª—å–∑—É–π –ø–ª–∞–≤–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è –∏ –∏–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏—é."
    },
    {
        id: "medium_5",
        difficulty: "medium",
        category: "logical",
        title: "–ú–∞—Ä—à—Ä—É—Ç —á–µ—Ä–µ–∑ –∞—Å—Ç–µ—Ä–æ–∏–¥–Ω–æ–µ –ø–æ–ª–µ", 
        description: "–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–ª–æ–∂–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç —á–µ—Ä–µ–∑ –ø–æ–ª–µ –∏–∑ 10 –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤. –û–ø–∏—à–∏ —Å–≤–æ—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é.",
        hint: "–ü–æ–¥—É–º–∞–π –æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏, –º–∞–Ω–µ–≤—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –ø—É—Ç—è—Ö."
    },

    // –°–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
    {
        id: "hard_1",
        difficulty: "hard",
        category: "creative",
        title: "–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞", 
        description: "–ü—Ä–∏–¥—É–º–∞–π –∏ —Ä–∞—Å—Å–∫–∞–∂–∏ –∫–æ—Ä–æ—Ç–∫—É—é –∏—Å—Ç–æ—Ä–∏—é (2-3 –º–∏–Ω—É—Ç—ã) –æ –ø–µ—Ä–≤–æ–º –∫–æ–Ω—Ç–∞–∫—Ç–µ —Å –∏–Ω–æ–ø–ª–∞–Ω–µ—Ç–Ω–æ–π —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–µ–π.",
        hint: "–£–¥–µ–ª–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –¥–µ—Ç–∞–ª—è–º, —ç–º–æ—Ü–∏—è–º –∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –ø–æ–≤–æ—Ä–æ—Ç–∞–º —Å—é–∂–µ—Ç–∞."
    },
    {
        id: "hard_2",
        difficulty: "hard",
        category: "social",
        title: "–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞", 
        description: "–î–≤–µ –∏–Ω–æ–ø–ª–∞–Ω–µ—Ç–Ω—ã–µ —Ä–∞—Å—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç –∏–∑-–∑–∞ —Ä–µ—Å—É—Ä—Å–æ–≤. –ü—Ä–µ–¥–ª–æ–∂–∏ –¥–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ.",
        hint: "–ò—â–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –∏ –≤–∑–∞–∏–º–æ–≤—ã–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω."
    },
    {
        id: "hard_3",
        difficulty: "hard",
        category: "knowledge", 
        title: "–ö–æ–ª–æ–Ω–∏—è –Ω–∞ –ú–∞—Ä—Å–µ",
        description: "–û–ø–∏—à–∏ –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω —Å–æ–∑–¥–∞–Ω–∏—è —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∫–æ–ª–æ–Ω–∏–∏ –Ω–∞ –ú–∞—Ä—Å–µ –Ω–∞ 1000 —á–µ–ª–æ–≤–µ–∫.",
        hint: "–£—á—Ç–∏ –∂–∏–ª—å—ë, –ø–∏—Ç–∞–Ω–∏–µ, —ç–Ω–µ—Ä–≥–∏—é, –∫–∏—Å–ª–æ—Ä–æ–¥ –∏ –∑–∞—â–∏—Ç—É –æ—Ç —Ä–∞–¥–∏–∞—Ü–∏–∏."
    },
    {
        id: "hard_4",
        difficulty: "hard",
        category: "physical",
        title: "–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –π–æ–≥–∞", 
        description: "–ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–π 3 –∞—Å–∞–Ω—ã –π–æ–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã –∞—Å—Ç—Ä–æ–Ω–∞–≤—Ç–∞–º –≤ –Ω–µ–≤–µ—Å–æ–º–æ—Å—Ç–∏.",
        hint: "–°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–∏, –≥–∏–±–∫–æ—Å—Ç–∏ –∏ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–∏."
    },
    {
        id: "hard_5",
        difficulty: "hard",
        category: "logical",
        title: "–í—Ä–µ–º–µ–Ω–Ω–∞—è –ø–µ—Ç–ª—è", 
        description: "–¢—ã –ø–æ–ø–∞–ª –≤ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–µ—Ç–ª—é. –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è. –ö–∞–∫ –±—ã —Ç—ã –¥–æ–∫–∞–∑–∞–ª —ç—Ç–æ –¥—Ä—É–≥–∏–º –∏ –Ω–∞—à—ë–ª –≤—ã—Ö–æ–¥?",
        hint: "–ò—â–∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ –æ—Å—Ç–∞–≤–ª—è–π —Å–æ–æ–±—â–µ–Ω–∏—è —Å–≤–æ–µ–º—É –±—É–¥—É—â–µ–º—É —è."
    }
];

// –ú–∞–≥–∞–∑–∏–Ω –ø—Ä–µ–¥–º–µ—Ç–æ–≤
const SHOP_ITEMS = {
    boosters: [
        {
            id: "double_reward",
            name: "–£–¥–≤–æ–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã",
            icon: "üí∞",
            price: 50,
            description: "–°–ª–µ–¥—É—é—â–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –ø—Ä–∏–Ω–µ—Å—ë—Ç –≤ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –º–æ–Ω–µ—Ç",
            category: "boosters",
            effect: "next_reward_double"
        },
        {
            id: "extra_roll",
            name: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±—Ä–æ—Å–æ–∫",
            icon: "üé≤",
            price: 30,
            description: "–ü–æ–ª—É—á–∏ –ø—Ä–∞–≤–æ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–∞ –≤ —Å–≤–æ–π —Ö–æ–¥",
            category: "boosters", 
            effect: "extra_dice_roll"
        },
        {
            id: "task_skip",
            name: "–ü—Ä–æ–ø—É—Å–∫ –∑–∞–¥–∞–Ω–∏—è",
            icon: "‚è≠Ô∏è",
            price: 25,
            description: "–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ –±–µ–∑ —à—Ç—Ä–∞—Ñ–∞",
            category: "boosters",
            effect: "free_skip"
        }
    ],
    powers: [
        {
            id: "time_extend",
            name: "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏",
            icon: "‚è∞",
            price: 40,
            description: "+30 —Å–µ–∫—É–Ω–¥ –∫ —Ç–∞–π–º–µ—Ä—É —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è",
            category: "powers",
            effect: "time_extend_30"
        },
        {
            id: "difficulty_choice",
            name: "–í—ã–±–æ—Ä —Å–ª–æ–∂–Ω–æ—Å—Ç–∏", 
            icon: "üéØ",
            price: 60,
            description: "–ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è",
            category: "powers",
            effect: "choose_difficulty"
        },
        {
            id: "coin_magnet",
            name: "–ú–∞–≥–Ω–∏—Ç –º–æ–Ω–µ—Ç",
            icon: "üß≤",
            price: 75,
            description: "–ü–æ–ª—É—á–∞–π +5 –º–æ–Ω–µ—Ç –∑–∞ –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞, –Ω–∞—Ö–æ–¥—è—â–µ–≥–æ—Å—è –Ω–∞ —Ç–æ–π –∂–µ –∫–ª–µ—Ç–∫–µ",
            category: "powers",
            effect: "coin_magnet"
        }
    ],
    cosmetics: [
        {
            id: "golden_avatar",
            name: "–ó–æ–ª–æ—Ç–æ–π –∞–≤–∞—Ç–∞—Ä",
            icon: "üåü",
            price: 100,
            description: "–û—Å–æ–±–∞—è –∑–æ–ª–æ—Ç–∞—è —Ä–∞–º–∫–∞ –¥–ª—è —Ç–≤–æ–µ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞",
            category: "cosmetics",
            effect: "golden_frame"
        },
        {
            id: "sparkle_trail",
            name: "–°–≤–µ—Ä–∫–∞—é—â–∏–π —Å–ª–µ–¥",
            icon: "‚ú®",
            price: 80,
            description: "–ö—Ä–∞—Å–∏–≤—ã–π –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–µ–¥ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –ø–æ –ø–æ–ª—é",
            category: "cosmetics",
            effect: "sparkle_trail"
        },
        {
            id: "victory_animation",
            name: "–û—Å–æ–±–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ–±–µ–¥—ã",
            icon: "üéâ",
            price: 150,
            description: "–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –ø–æ–±–µ–¥–µ –≤ –∏–≥—Ä–µ",
            category: "cosmetics",
            effect: "special_win_animation"
        }
    ]
};

// –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ –ø–æ–ª—è
const SPECIAL_CELLS = {
    0: { type: "start", name: "–°—Ç–∞—Ä—Ç", effect: "start" },
    8: { type: "shop", name: "–ú–∞–≥–∞–∑–∏–Ω", effect: "shop_discount" },
    16: { type: "event", name: "–ö–æ—Å–º–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ", effect: "random_event" },
    24: { type: "challenge", name: "–ò—Å–ø—ã—Ç–∞–Ω–∏–µ", effect: "special_challenge" },
    31: { type: "finish", name: "–§–∏–Ω–∏—à", effect: "finish_bonus" }
};

// –¶–≤–µ—Ç–∞ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤
const PLAYER_COLORS = [
    "#ef4444", "#f59e0b", "#10b981", "#3b82f6",
    "#8b5cf6", "#ec4899", "#06b6d4", "#84cc16",
    "#f97316", "#6366f1", "#d946ef", "#0ea5e9",
    "#22c55e", "#eab308", "#a855f7", "#f43f5e"
];

const PLAYER_AVATARS = [
    "üë®‚ÄçüöÄ", "üë©‚ÄçüöÄ", "üõ∏", "üöÄ", "‚≠ê", "üåå", "ü™ê", "‚òÑÔ∏è",
    "üëΩ", "ü§ñ", "üêô", "ü¶Ñ", "üê≤", "ü¶Å", "üêØ", "üêµ"
];

// –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
class TaskGenerator {
    constructor() {
        this.usedTasks = new Set();
    }

    getRandomTask(difficulty = null) {
        // –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞–¥–∞–Ω–∏—è –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞
        let availableTasks = TASKS_DATABASE.filter(task => 
            !this.usedTasks.has(task.id) && 
            (!difficulty || task.difficulty === difficulty)
        );

        // –ï—Å–ª–∏ –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
        if (availableTasks.length === 0) {
            this.usedTasks.clear();
            availableTasks = TASKS_DATABASE.filter(task => 
                !difficulty || task.difficulty === difficulty
            );
        }

        if (availableTasks.length === 0) {
            // Fallback –∑–∞–¥–∞–Ω–∏–µ
            return {
                id: "fallback",
                difficulty: "medium",
                category: "knowledge",
                title: "–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥–∞–¥–∫–∞",
                description: "–ß—Ç–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ, –Ω–æ –∏–º–µ–µ—Ç –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü?",
                hint: "–ü–æ–¥—É–º–∞–π –æ —á—ë–º-—Ç–æ, —á—Ç–æ –Ω–∞—Å –æ–∫—Ä—É–∂–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ."
            };
        }

        // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
        const randomIndex = Math.floor(Math.random() * availableTasks.length);
        const task = availableTasks[randomIndex];
        
        // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–µ
        this.usedTasks.add(task.id);
        
        return task;
    }

    getTaskByDifficulty() {
        const random = Math.random();
        let difficulty;

        if (random < DIFFICULTY_LEVELS.easy.probability) {
            difficulty = "easy";
        } else if (random < DIFFICULTY_LEVELS.easy.probability + DIFFICULTY_LEVELS.medium.probability) {
            difficulty = "medium";
        } else {
            difficulty = "hard";
        }

        return this.getRandomTask(difficulty);
    }

    markTaskAsUsed(taskId) {
        this.usedTasks.add(taskId);
    }

    resetUsedTasks() {
        this.usedTasks.clear();
    }
}

// –£—Ç–∏–ª–∏—Ç—ã
function getRandomColor() {
    return PLAYER_COLORS[Math.floor(Math.random() * PLAYER_COLORS.length)];
}

function getRandomAvatar() {
    return PLAYER_AVATARS[Math.floor(Math.random() * PLAYER_AVATARS.length)];
}

function generatePlayerName(index) {
    const names = [
        "–ö–æ—Å–º–æ–Ω–∞–≤—Ç", "–ó–≤—ë–∑–¥–Ω—ã–π", "–ì–∞–ª–∞–∫—Ç–∏–∫–∞", "–û—Ä–±–∏—Ç–∞", 
        "–ö–æ–º–µ—Ç–∞", "–ê—Å—Ç–µ—Ä–æ–∏–¥", "–¢—É–º–∞–Ω–Ω–æ—Å—Ç—å", "–°–æ–∑–≤–µ–∑–¥–∏–µ",
        "–ü—É–ª—å—Å–∞—Ä", "–ö–≤–∞–∑–∞—Ä", "–ù–µ–π—Ç—Ä–æ–Ω", "–ü—Ä–æ—Ç–æ–Ω",
        "–§–æ—Ç–æ–Ω", "–≠–ª–µ–∫—Ç—Ä–æ–Ω", "–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞", "–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è"
    ];
    return `${names[index]} ${Math.floor(Math.random() * 1000)}`;
}

// –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ game.js
if (typeof module !== 'undefined' && module.exports) {
    module.exports = {
        GAME_CONFIG,
        DIFFICULTY_LEVELS,
        TASK_CATEGORIES,
        TASKS_DATABASE,
        SHOP_ITEMS,
        SPECIAL_CELLS,
        PLAYER_COLORS,
        PLAYER_AVATARS,
        TaskGenerator,
        getRandomColor,
        getRandomAvatar,
        generatePlayerName
    };
}
